---
title: "Projekt Speed Dating"
author: "Fran Canjuga, Gašpar Haramija, Leon Hegedić, Josipa Markić"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

## Učitavanje i prikaz podataka

```{r}
participants = read.csv("participant_data.csv")
dates = read.csv("speed_date_data.csv")
head(participants)
head(dates)
```
Na temelju podataka vidimo da je set podataka za participante sadrži 40 stupaca dok za podatke o spojevima sadrži 19.  

Tu se može izbaciti stupce koji nisu uopće potrebni u analizi jer se iz njih ne moze nist zaključiti. Osim toga možemo tu raditi pomoćne datasetove koji će se koristiti u određenim analizama, npr. priprema podataka za linearnu regresiju. 

Osim toga promijeniti klase nekih varijabla koje nisu tocne u pocetnim datasetovima...npr. spol mozemo pretvoriti u numericku ako je lakse, "importance_same_race" je klasa character (nije mi jasno zakaj)

U dates data frameu ima dosta podataka koji su NA, odluciti kaj tocno napraviti s njima


## Drugo istraživacko pitanje glasi : Postoji li razlika u interesu za gaming prema zanimanju sudionika?

Za ovo pitanje bitni su nam podaci o zanimanju sudionika te o interesu koji imaju za gaming.Potrebno je podatke očistiti prije njihovog korištenja.
Podatke o interesu za gaming ćemo očistiti na način da se nepostojeći podaci o ocjeni zamjene sa medijanom svih ocjena svih sudionika.
Podatke o zanimanju sudionika očistit ćemo tako što čemo ukloniti podatke o sudionicima za koje je zanimanje ne definirano.

Prije opisanog procesa ćemo u novi data frame staviti stupce iz tablice participants koje ćemo koristiti. U ovom slučaju to su gaming i field stupci
```{r}
df_field_gaming <- participants[, c("gaming", "field")]
names(df_field_gaming) # ispisuje imena stupaca
dim(df_field_gaming) # dimenzije novo stvorenog data frame-a participants_data
class(df_field_gaming$gaming)
class(df_field_gaming$field)
```
Iz ovog ispisa vidljivo je da se tablica sastoji od 540 redaka, drugim riječima, imamo podatke o 540 sudionika te o njihovom interesu za gaming i njihovom zanimanju. Također vidimo da podaci u stupcu gaming pripadaju klasi "integer", a u stupcu field klasi "character" iz čega zaključujemo da su ocjene za interes za gaming cijeli brojevi na intervalnoj skali, a zanimanje sudionika je kategorijska varijabla.

```{r}
summary(df_field_gaming$gaming)
sum(df_field_gaming$gaming > 10)
sum(is.na(df_field_gaming$gaming)) # nepostojeće vrijednosti za gaming
sum(is.na(df_field_gaming$field)) # nepostojeće vrijenosti za field
length(unique(df_field_gaming$field)) # različite vrijednosti u field

df_field_gaming$gaming[df_field_gaming$gaming > 10] <- 10
df_field_gaming$gaming[df_field_gaming$gaming < 1] <- 1
```
Za naše pitanje odnosa interesa za gaming i zanimanja sudionika relevantne su kategorijska varijabla zanimanja i numerička varijabla ocjene na intervalnoj skali. Iz tog razloga daljnjoj analizi pristupiti ćemo na dva različita načina: 

1. način 
  Kategorizacija ocjena za gaming kako bismo mogli testirati nezavisnost između dvije kategorijske varijable. Test nezavisnosti u programskom jeziku R kao ulaz prima kontigencijsku tablicu te treba imati na umu da je pretpostavka testa da je očekivana frekvencija pojedinog razreda mora biti veća ili jednaka 5.

2. način
  Provjera primjenom jednofaktorske ANOVE, metoda kojom testiramo sredine više populacija te joj je cilj odrediti jesu li razliku između grupa statistički značajne. 

Iz ispisa ocjena za gaming zakljucujemo da ima 5 vrijednosti ocjena koje su veće od 10, 2 vrijednosti koje su manje od 1 te da nema nepostojećih vrijednosti. U procesu čišćenja podataka smo vrijednosti koje su veće od 10 zamijenili sa 10, a vrijednosti koje su manje od 1 zamijeniti sa 1. Također nema nepostojećih vrijednosti u stupcu field te stoga možemo koristiti ovaj data frame u daljnjoj analizi. Za oba navedena načina potrebno je dodatno kategorizirati zanimanja sudionika.

```{r}
levels_field <- levels(factor(df_field_gaming$field))
print(levels_field[1:20])
length(unique(df_field_gaming$field))
```
Ovdje smo ispisali samo dio različitih vrijednosti u stupcu field kojih ima 252. Kao što smo napomenuli, zanimanje sudionika je kategorijska varijabla i mnoge od tih vrijednosti imaju zajedničke karakteristike koje ih svrstavaju u istu kategoriju. Prije nastavka analize potrebno je zanimanja sudionika grupirati u manji broj kategorija. U procesu grupiranja sva srodna zanimanja ćemo staviti u istu kategoriju na način da kategorije budu nezavisne. 

Postoje mnogi načini za svrstavanje zanimanja sudionika u ovom slučaju na različite podskupove. Cilj podjele na manji broj kategorija bio je dobiti nezavisne podskupove zanimanja sa zajedničkim karakteristikama kako bi kategorije bile relevantne za predmet našeg istraživanja - razlika u interesu za gaming prema zanimanju korisnika. Osim koherencije kategorija cilj je bio i smanjenje dimenzionalnosti uz, ukoliko je moguće, održavanje podjednake raspodjele sudionika po kategorijama. Ovim smjernicama stvarali smo kategorije srodnih zanimanja te smo metodom pokušaja i pogreške došli do sljedeće kategorizacije - Business&Economics, STEM, Social Studies&Humanities, Law&International Affairs.

```{r}
bussines_economics_keywords <- c("economy", "economics", "econs", "finance", "finanace", "financial", "business", "consulting", "fundraising", "marketing", "mba", "money")

stem_keywords <- c("architecture", "engineering", "operations research", "engg.", "computer science", "science", "scientific", "chemistry", "biology", "biotechnology", "biotechnology", "biochemsistry", "epidemiology", "genetics", "physics", "marine geophysics", "mathematics", "math", "statistics", "stats", "applied maths", "climate", "ecology", "urban planning", "nutrition", "physiology", "nutritiron", "health", "medical informatics", "speech", "medicine", "biomedicine", "biomedical")

social_studies_humanities_keyword <- c("american studies", "history", "anthropology", "qmss", "psychology", "sociology", "social", "ma in quantitative methods", "philosophy", "religion", "literature", "english", "french", "poetry", "writing", "polish", "classics", "education", "teaching", "instructional ", "tesol", "art", "arts", "acting", "film", "theater", "theatre", "communications", "journalism")

law_keywords <- c("law", "human rights", "international", "intrernational affairs", "public", "relations")

categorize_field <- function(field) {
  matches <- c(
    any(grepl(paste(bussines_economics_keywords, collapse = "|"), field, ignore.case = TRUE)),
    any(grepl(paste(stem_keywords, collapse = "|"), field, ignore.case = TRUE)),
    any(grepl(paste(social_studies_humanities_keyword, collapse = "|"), field, ignore.case = TRUE)),
    any(grepl(paste(law_keywords, collapse = "|"), field, ignore.case = TRUE))
  )
  
  if (sum(matches) > 1) {
    return(field)
  } else {
    if (matches[1]) return("Business&Economics")
    if (matches[2]) return("STEM")
    if (matches[3]) return("Social Studies&Humanities")
    if (matches[4]) return("Law & International Affairs")
    return(field)
  }
}

df_field_gaming$field = sapply(df_field_gaming$field, categorize_field)
```

```{r}
zadane_kategorije <- c("Business&Economics", "Law & International Affairs", "STEM", "Social Studies&Humanities")

redovi_bez_zadanih_kategorija <- subset(df_field_gaming, !(field %in% zadane_kategorije))

head(redovi_bez_zadanih_kategorija)

```

Pregledavanjem nesvrstanih zanimanja koja se ne mogu dodati u kategorije kako bi se zadržala nezavisnost, za neka smo zaključili da se mogu uključiti.Također postoje i podaci koji nisu iskoristivi jer ne daju zanimanje sudionika. Sve navedene podatke smo očistili i neće se koristit u testovima.

```{r}
if ("Climate-Earth and Environ. Science" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "Climate-Earth and Environ. Science"] <- "STEM"
}
if ("international finance and business" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "international finance and business"] <- "Business&Economics"
}
if ("International Business" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "International Business"] <- "Business&Economics"
}
if ("International Finance" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "International Finance"] <- "Business&Economics"
}
if ("Financial Engineering" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "Financial Engineering"] <- "Business&Economics"
}
if ("Law and Social Work" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "Law and Social Work"] <- "Law & International Affairs"
}
if ("Public Health" %in% df_field_gaming$field) {
  df_field_gaming$field[participants$field == "Public Health"] <- "STEM"
}

df_field_gaming <- subset(df_field_gaming, field %in% zadane_kategorije)
```


```{r}
table(df_field_gaming$field)
length(unique(df_field_gaming$field))
dim(df_field_gaming)
```

Nakon kategorizacije zanimanja sudionika imamo četiri kategorije zanimanja: 
  - Business&Economics,
  - Law & International Affairs,
  - Social Studies&Humanities,
  - STEM 
U nastavku slijede mjere centralne tendencije za navedena zanimanja te vizualizacija podataka, također i za gaming.

# Vizualizacija i prikaz podataka

```{r}
aggregate(df_field_gaming["gaming"], list(df_field_gaming$field), mean)
aggregate(df_field_gaming["gaming"], list(df_field_gaming$field), median)
aggregate(df_field_gaming["gaming"], list(df_field_gaming$field), var)

```
Na temelju medijana, aritmetičke sredine i varijance ocjena za gaming grupiranih po prije određenim kategorijama na prvi pogled možemo primjetiti da je vrijednost aritmetičke sredine manja za jednu ocjenu, a vrijednost medijana za dvije ocjene od ostalih kategorija.

```{r}
boxplot(df_field_gaming[df_field_gaming["field"]=="Business&Economics",]$gaming,
        main='Business&Economics - Gaming box-plot',
        ylab='Gaming grade',
        xlab='Business&Economics',
        col = "pink")

boxplot(df_field_gaming[df_field_gaming["field"]=="Law & International Affairs",]$gaming,
        main='Law & International Affairs - Gaming box-plot',
        ylab='Gaming grade',
        xlab='Law & International Affairs',
        col = "pink")

boxplot(df_field_gaming[df_field_gaming["field"]=="Social Studies&Humanities",]$gaming,
        main='Social Studies&Humanities - Gaming box-plot',
        ylab='Gaming grade',
        xlab='Social Studies&Humanities',
        col = "pink")

boxplot(df_field_gaming[df_field_gaming["field"]=="STEM",]$gaming,
        main='STEM - Gaming box-plot',
        ylab='Gaming grade',
        xlab='STEM',
        col = "pink")


#boxplot(df_field_gaming$gaming ~ df_field_gaming$field)

boxplot(gaming ~ field, df_field_gaming,
        main = "Boxplot ocjena interesa za gaming po kategorija",
        xlab = "Kategorije",
        ylab = "Ocjena interesa za gaming",
        col = "pink"  # Boja boxplot-a
)
```
Prije primjećena manja vrijednost medijana vidljiva je i na prikazanom boxplotu ocjena interesa za gaming po kategorijama.


```{r}
hist(df_field_gaming$gaming,
     breaks = seq(min(df_field_gaming$gaming) - 0.5, max(df_field_gaming$gaming) + 0.5, 1),
     main = "Histogram ocjena za gaming svih sudionika",
     xlab = "Ocjena interesa za gaming"
)
```




```{r}

barplot(
  t(table(df_field_gaming$gaming, df_field_gaming$field)),
  col = c('lightblue', 'purple', 'green', 'red'),
  beside = TRUE,
  legend.text = TRUE,
  xlab = 'Ocjena za interes za gaming',
  ylab = 'Frekvencija',
  main = 'Barplot za kategorije'
)

```
```{r}
table(df_field_gaming$gaming, df_field_gaming$field)
max_length <- max(table(df_field_gaming$gaming, df_field_gaming$field))
# Kreiranje linijskog plot-a
plot(1:10, table(df_field_gaming$gaming[df_field_gaming$field == "STEM"]), type = 'l', col = 'red',
     xlim = c(min(df_field_gaming$gaming), max(df_field_gaming$gaming)),
     ylim = c(0, 100),
     xlab = 'Ocjena za interesa za gaming', ylab = 'Frekvencija', main = 'Linijski plot za kategorije')

# Dodavanje linijskih plot-ova za ostale kategorije
lines(1:10, table(df_field_gaming$gaming[df_field_gaming$field == "Business&Economics"]), col = 'lightblue')
lines(1:10, table(df_field_gaming$gaming[df_field_gaming$field == "Law & International Affairs"]), col = 'purple')
lines(1:max_length, table(df_field_gaming$gaming[df_field_gaming$field == "Social Studies&Humanities"])[1:max_length], col = 'lightgreen')

# Dodavanje legendi
legend("topright",c("Business&Economics","Law & International Affairs", "Social Studies&Humanities","STEM"),fill = c("lightblue", "purple", "lightgreen", "red"))
```


Koristeći različite vrste prikaza podataka za vrstu kojom raspolazemo, kategorijska varijabla područja zanimanja i numerička varijabla ocjene, prikazali smo raspodjelu podataka po kategroijama i ocjenama unutar svake kategorije te međusobno između kategorija.

Nakon vizualizacije podataka nastavit ćemo sa prije spomenutim prvim načinom pristupa ovom pitanju odnosa interesa za gaming prema zanimanju sudionika. To podrazumijeva kategorizaciju ocjena za gaming kako bismo testirali nezavisnost između dvije tada kategorijske varijable - područje zanimanje, ocjena intersa za gaming. Kategorija ocjene varijabla je na ordinalnoj skali dok je kategorija područja zanimanja kategorijska varijabla nominalne skale - područja zanimanja ne mogu se rangirati dok se kategorije ocjena mogu.

# Test nezavisnosti kategorijskih varijabli
Test nezavisnosti, $\chi^2$ test, u programskom paketu R implementiran je u funkciji `chisq.test()` koja kao ulaz prima kontingencijsku tablicu podataka koje testiramo na nezavisnost. Također,test nezavisnosti koristi se kako bi se provjerilo postoji li statistički značajna veza između dvije kategorijske varijable, u našem slučaju kategorije ocjena i područja zanimanja. 
Stoga, hipoteze za navedeni test su sljedeće:
Nulta hipoteza - nema statistički značajne veze između zanimanja sudionika i interesa za gaming.
$$ \begin{aligned}
  H_0 & : \text{Područje zanimanja sudionika i interes za gaming su nezavisne varijable}.
\end{aligned} $$
Alternativna hipoteza - Postoji statistički značajna veza između zanimanja sudionika i interesa za gaming.
$$ \begin{aligned}
  H_1 & : \text{Područje animanja sudionika i interes za gaming nisu nezavisne varijable.}.
\end{aligned} $$

Ako p-vrijednost dobivena testom bude dovoljno mala - manja od 0.05, odbit ćemo nultu hipotezu i zaključiti da postoji statistički značajna veza.

Test nezavisnosti u jeziku R prima kontigencijsku tablicu kao ulazt te treba imati na umu pretpostavku da je frekvencija očekivanog razreda veća ili jednaka 5.

Prvi korak za navedeno ispitivanje je kategoriziranje ocjena interesa za gaming. To ćemo napraviti na sljedeći način, ocjene koje su cijeli brojevi od 1 do 10 ćemo podijeliti u tri nezavisne kategorije: Niska, Srednja i Visoka. Gdje će u grupi Niska biti ocjene od 1 do 2, u grupi Srednja ocjene od 3 do 6 i u grupi Visoka ocjene od 7 do 10.


```{r}
df_field_gaming <- df_field_gaming %>%
  mutate(kat_gaming = case_when(
    gaming %in% 0:2 ~ "Niska",
    gaming %in% 3:6 ~ "Srednja",
    TRUE ~ "Visoka"
  ))

# Ispisivanje rezultata
head(df_field_gaming)
```

```{r}
kat_gaming_count <- table(df_field_gaming$kat_gaming)
print(kat_gaming_count)
barplot(kat_gaming_count, 
        main = "Histogram ocjena kategorija",
        xlab = "Kategorija ocjene",
        ylab = "Broj ocjena u kategoriji",
        col = c("red", "green", "blue"),  # Boje za svaku kategoriju
        legend.text = TRUE
)
```

Nakon kategorizacije ocjena interesa za gaming možemo nastaviti sa prikazom kontigencijske tablice, zatim dodavanjem marginalnih suma i provjerom pretpostavke testa nezavisnosti.

Kontigencijska tablica

```{r}
kontigencijska_tabl <- table(df_field_gaming$field, df_field_gaming$kat_gaming)
kontigencijska_tabl
```

```{r}
margine_tabl = addmargins(kontigencijska_tabl)
print(margine_tabl)
```

Provjera pretpostavke testa nezavisnosti - očekivane frekvencije moraju biti veće ili jednake od 5.

```{r}
for (col_names in colnames(margine_tabl)){
  for (row_names in rownames(margine_tabl)){
    if (!(row_names == 'Sum' | col_names == 'Sum') ){
      cat('Očekivane frekvencije za razred ',col_names,'-',row_names,': ',(margine_tabl[row_names,'Sum'] * margine_tabl['Sum',col_names]) / margine_tabl['Sum','Sum'],'\n')
    }
  }
}
```

Sve očekivane frekvencije su veće od 5. Možemo nastaviti sa $\chi^2$ testom.

```{r}
chisq.test(kontigencijska_tabl,correct=F)
```

P-vrijednost manje je od prije definirane vrijednosti 0.05, ona iznosti 0.002724 te iz tog razloga odbacijemo nultu hipotezu u korist alternativne. Postoji statistički značajna veza između zanimanja sudionika i interesa za gaming to jest područje zanimanja sudionika i njegov interes za gaming zavisne su varijable.

# Provjera primjenom jednofaktorske ANOVE

Sada ćemo nastaviti sa drugim pristupom ovom pitanju, primjenom jednofaktorske ANOVE gdje ne gledamo ocjene kao kategorijsku varijabu nego nuemričku.

ANOVA (engl. *ANalysis Of VAriance*) metoda je kojom testiramo sredive više populacija te pretpostavlja  da je ukupna varijabilnost u podatcima posljedica varijabilnosti podataka unutar svakog pojedine grupe (populacije) i varijabilnosti između različitih grupa. Varijabilnost unutar pojedinog uzorka je rezultat slučajnosti, a ako postoje razlike u sredinama populacija, one će biti odražene u varijabilnosti među grupama. Jedan od glavnih ciljeva analize varijance je ustanoviti jesu li upravo te razlike između grupa samo posljedica slučajnosti ili je statistički značajna.

U jednofaktorskom ANOVA modelu razmatra se utjecaj jednog faktora koji ima $k$ razina.
Neka su:
$$ \begin{aligned}
  X_{11}, X_{12}, \ldots, X_{1n_1} & \sim N(\mu_1, \sigma^2) \\
  X_{21}, X_{22}, \ldots, X_{2n_2} & \sim N(\mu_2, \sigma^2) \\
  & \vdots\\
  X_{k1}, X_{k2}, \ldots, X_{kn_k} & \sim N(\mu_k, \sigma^2)
\end{aligned} $$
nezavisni uzorci iz $k$ različitih populacija (populacije se razlikuju upravo po razini faktora od interesa). Jednofaktorski ANOVA model glasi:
$$ X_{ij} = \mu_{i} + \epsilon_{ij}, $$
gdje je $\mu_{i}$ sredina svake populacije $i = 1,..,k$. Analizom varijance testiramo:
$$ \begin{aligned}
  H_0 & : \mu_1 = \mu_2 = \ldots = \mu_k \\
  H_1 & : \text{barem dvije sredine nisu iste}.
\end{aligned} $$

Kako bi krenuli s analizom ANOVE moramo ispitati njene pretpostavke, a to su:
  1.    nezavisnost pojedinih podataka u uzorcima
  2.    normalna razdioba podataka
  3.    homogenost varijanci među populacijama
  
Nezavisnost podataka u populacijama smo osigurali kategorizacijom područja zanimanja iz tog razloga je taj uvjet ispunjen. Nastavljamo sa uvjetom homogenosti varijanic među populacijama. Ova pretpostavka je važna kako bi ANOVA bila pouzdana, a njezino kršenje može dovesti do netočnih rezultata. 
Što se tiče homogenosti varijanci različitih populacija, potrebno je testirati:
$$ \begin{aligned}
  H_0 & : \sigma_1^2 = \sigma_2^2 = \ldots = \sigma_k^2 \\
  H_1 & : \text{barem dvije varijance nisu iste}.
\end{aligned} $$

Navedenu hipotezu možemo testirati Bartlettovim testom. Bartlettov test u R-u implementiran je naredbom `bartlett.test()`.

```{r test pretpostavki - homogenost varijanci}

# Testiranje homogenosti varijance uzoraka Bartlettovim testom
bartlett.test(df_field_gaming$gaming ~ df_field_gaming$field)

var((df_field_gaming$gaming[df_field_gaming$field=='Business&Economics']))
var((df_field_gaming$gaming[df_field_gaming$field=='Law & International Affairs']))
var((df_field_gaming$gaming[df_field_gaming$field=='Social Studies&Humanities']))
var((df_field_gaming$gaming[df_field_gaming$field=='STEM']))
```
Dobivena p-vrijednost Barlettovim testom, 0.9461, ukazuje na to da nema dovoljno statističkih dokaza da varijance nisu jednake. Stoga, zaključujemo i da nema dovoljno dokaza da su varijance različite među populacijama koje predstavljaju različita područja zanimanja sudionika. Ovo podržava homogenost varijanci - na temelju rezultata ne odbacujemo nultu hipotezu.

Potrebno je još provjeriti pretpostavku normalnosti. Provjera normalnosti može se za svaku pojedinu grupu napraviti Kolmogorov-Smirnov testom ili Lillieforsovom inačicom Kolmogorov-Smirnov testa.

```{r test pretpostavki - normalnost}

require(nortest)
lillie.test(df_field_gaming$gaming)

lillie.test(df_field_gaming$gaming[df_field_gaming$field=='Business&Economics'])
lillie.test(df_field_gaming$gaming[df_field_gaming$field=='Law & International Affairs'])
lillie.test(df_field_gaming$gaming[df_field_gaming$field=='Social Studies&Humanities'])
lillie.test(df_field_gaming$gaming[df_field_gaming$field=='STEM'])

hist(df_field_gaming$gaming[df_field_gaming$field=='Business&Economics'])
hist(df_field_gaming$gaming[df_field_gaming$field=='Law & International Affairs'])
hist(df_field_gaming$gaming[df_field_gaming$field=='Social Studies&Humanities'])
hist(df_field_gaming$gaming[df_field_gaming$field=='STEM'])
```

Testiranjem normalnosti zaključujemo da nije zadovoljen uvjet normalnosti jer je p-vrijednost testa manja od odabrane razine značajnosti, 0.05. Kao sljedeći korak pokušat ćemo transformirati podatke kako bismo ih približili normalnoj distribuciji - koristit više transformacijskih tehnika te odabrati najboljju. Ovdje je prikzana logaritamska transformacija. Nakon transformacije ćemo provesti test normalnosti.

```{r test pretpostavki - normalnost nakon transformacije}
df_field_gaming$log_gaming <- log(df_field_gaming$gaming)

require(nortest)
lillie.test(df_field_gaming$log_gaming)

lillie.test(df_field_gaming$log_gaming[df_field_gaming$field=='Business&Economics'])
lillie.test(df_field_gaming$log_gaming[df_field_gaming$field=='Law & International Affairs'])
lillie.test(df_field_gaming$log_gaming[df_field_gaming$field=='Social Studies&Humanities'])
lillie.test(df_field_gaming$log_gaming[df_field_gaming$field=='STEM'])


hist(df_field_gaming$log_gaming[df_field_gaming$field=='Business&Economics'])
hist(df_field_gaming$log_gaming[df_field_gaming$field=='Law & International Affairs'])
hist(df_field_gaming$log_gaming[df_field_gaming$field=='Social Studies&Humanities'])
hist(df_field_gaming$log_gaming[df_field_gaming$field=='STEM'])
```
Ekspermentiranjem sa transformacijskim tehnika nismo uspjeli transformirati ocjene interesa za gaming kako bismo potvrdili pretpostavku normalnosti podataka. Iz tog razloga ne možemo nastaviti sa provedbom ANOVA testa jer nisu ispunjene sve pretpostavke.

# KRUSKAL-WALLISOV TEST 
Nastavit ćemo sa neparametarskom alternativom jednofaktorske analize varijance koja se koristi kada nisu zadovoljene pretpostavke parametarske anove kao u našem slučaju.
                    
Hipotete Kruskal-Wallisovog testa su:
$$ \begin{aligned}
  H_0 & : M_1 = M_2 = \ldots = M_k \\
  H_1 & : \text{barem dva medijana nisu ista}.
\end{aligned} $$

 $M_{k}$ su medijani uzoraka

```{r test jednakosti medijana}
require(nortest)
kruskal.test(df_field_gaming$gaming ~ df_field_gaming$field, data = df_field_gaming)
```

Testiranjem smo dobili da je p-vrijednost 0.001117 te zaključujemo da možemo odbaciti nultu hipotezu u korist alternative - barem dva medijana nisu jednaka.


```{r grafički prikaz sredina populacija}
# Graficki prikaz podataka
boxplot(df_field_gaming$gaming ~ df_field_gaming$field)
```

Rezultat Kruskal-Wallisovog testa vidljiv je takođeri na prikazanom box plotu. U drugom načinu pristupa pitanju postoji li razlika za interes za gaming prema području zanimanja sudionika došli smo do zaključka da razlika postoji.

Drugim riječima, postoji statistički značajna razlika između ocjena interesa za gaming prema području zanimanja sudionika.